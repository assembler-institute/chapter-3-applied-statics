---
title: "SOLUCIÓN ACTIVIDAD 3"
output:
  html_notebook: default
  pdf_document:
    latex_engine: xelatex
  html_document: default
---
## Section A

We have the IQ (intelligence quotient) of a sample of 5 individuals: 110 100 115 105 104

We want (case 1) to calculate the confidence interval on the mean (at 95%) and (case 2) indicate whether such subjects have been drawn from a population with a mean of 100.


```{r}
coefint <- c(110,100,115,105,104)

#H0:mu=100 , H1: mu !=100

# (case 1) calculate the confidence interval about the mean (at 95%)
t.test(coefint,mu=100)$conf.int

# (case 2) indicate if such subjects have been drawn from a population with a mean of 100
#t.test(coefint,mu=100,conf.level = 0.99)

t.test(coefint,mu=100)

```
The confidence interval is 99.59193 114.00807 and the mean can be considered to be 100.

## Section B

Given the previously seen survey dataset, we want to test whether the difference in pulse rate between men and women is different or not. Can it be considered that the pulse rate of women is higher than that of men at a confidence level of 90%?


```{r}

library(MASS)

# test whether the difference in pulse between men and women is different or not

#H1: the mean difference between men and women is not equal to zero

t.test(Pulse~Sex,data=survey)

# can it be considered that the pulse rate of women is higher than that of men at a confidence level of 90%?

t.test(Pulse~Sex,alternative="g",data=survey,conf.level=0.9)


```


The mean difference between the pulse rates of both sexes cannot be considered neither different nor greater than zero.

## Section C

Taking into account Benford's Law, are they false invoices?


We perform a chi square goodness-of-fit test:

```{r}
prob <- c(0.301,0.176,0.125,0.097,0.079,0.067,0.058,0.051,0.046)
freqs <- c(7, 13, 12,  9,  9, 13, 11, 10, 16)

chisq.test(freqs,p=prob)

#H0: the distribution of the sample follows the proposed theoretical distribution

```

The distributions cannot be considered equal, therefore the invoices do not comply with the Benford Law and are potentially false. (p-value <0.05, we reject H0)



## Section D


We want to answer the question of whether it can be considered that with the three treatments the plants have the same growth.


Load the "PlantGrowth" dataset


```{r}
data("PlantGrowth")
PlantGrowth
head(PlantGrowth)
attach(PlantGrowth)
str(PlantGrowth)
```



-  Do an exploratory analysis


```{r}
boxplot(weight ~ group)
stripchart(weight ~ group, vertical=TRUE)
```
- Check model assumptions

These groups can be approximated by a normal distribution, they are independent of each other, they have different variances (the one-way ANOVA is applied with the Welch variant - variance difference assumption) and, within each sample, the observations must have been taken randomly and independently.

```{r}
meansd <- function(x) c(mean=mean(x), sd=sd(x))
by(weight, group, FUN=meansd)
```



```{r}

par(mfrow=c(3,1))
hist(weight[group=="ctrl"])
hist(weight[group=="trt1"])
hist(weight[group=="trt2"])
```
- Perform the one-way ANOVA
- What conclusions can be inferred from this sample?

We apply the one-way ANOVA on the three samples

H0: the means of your samples are equal
H1: The means of your samples are different

```{r}

oneway.test(weight ~ group) #They are different

```
We see that their p-value is less than 0.05 and therefore we accept the alternative hypothesis that their means are different.


If now we focus only on the samples generated by the ctrl and trt1 groups, we see that no significant differences can be considered, since when applying the one-way ANOVA test the p-value is greater than 0.05 and therefore the hypothesis is accepted null H0 equal means.

We therefore conclude that there are only two classes, the one formed by ctrl and trt1, and the one formed by trt2.

```{r}
#Between classes ctrl and trt1 njo it can be considered that there is a difference
PlantGrowth[group!="trt2",]

oneway.test(weight ~ group,data = PlantGrowth[group!="trt2",])
```


```{r}
#between the grouped classes ctrl+trt1 facing trt2:

M <- PlantGrowth
M[M$group=="ctrl","group"] <- "trt1"
M
```

We ask if the groups trt1 ( trt1 and crt1) and trt2 are equal ( null hypothesis)

```{r}

oneway.test(weight~group,M)

#it can be considered that there are only two classes

```

We reject H0 with a p-value < 0.05, so the samples are different, and these only two classes can be considered.

## Section E

Load the file "iqphys.csv", Does IQ depend on physical measurements?

Data description:

- Response (y)(IQ): Performance IQ (PIQ) scores from the Wechsler Adult Intelligence Scale-Revised. This variable was used by the researcher to measure the intelligence of the individual.
- Possible predictor (x1)(Brain): The size of the brain based on the estimate obtained from the MRIs (expressed as estimate/10,000).
- Possible predictor (x2)(Height): Height in inches.
- Possible predictor (x3)(Weight): Weight in pounds.


We load the dataset of cars and observe the correlation of the intellectual coefficient "PIG" with respect to the rest of the variables, in corr we have the correlation coefficient R:

```{r}

df <- read.csv('iqphys.csv',sep=',')

head(df)


str(df)

library(ggplot2)
library(GGally)

help(ggpairs)

ggpairs(df)

```
Which variables would we say, according to the previous matrix, that are correlated and which are not?

 
Height correlated with Weight and brain with Height, IQ not correlated with Wright and with Height

We can also obtain the correlation coefficients with the Pearson hypothesis test where the hypothesis we propose is the following:

**H0: variables are NOT correlated**
**H1: variables are correlated**

Starting from the rcorr function and converting our dataset into an array, we can select the parameters r
(to obtain the correlation coefficients between pairs of variables) and p (to obtain the pvalue of the Pearson 2 to 2 test)


We are going to select all the variables of the dataset:

```{r}

library(Hmisc)

corrs <- rcorr(as.matrix(df))

corrs$r #Pearson R correlation coefficients
corrs$P #pvalue of Pearson's test

```
**At first glance, which pair of variables accept H0? And which ones accept H1?**

IG with Height and with Weight , with a p-value >0.05 we accept the null hypothesis that our variables are not correlated.

Brain and Height, for example, with a p-value < 0.05 we reject H0, so we accept the alternative hypothesis that the variables Brain and Height are correlated.

```{r}

corrs$P>0.05

corrs$r>0.7

```

If we want to study specifically IQ with respect to the rest:

```{r}

R<- corrs$r
R

R[1,]

```
Another way to do it:

```{r}
cor(df)

cor(df$IQ, df)
```

We see your R²

**if we took the IQ variable as the target variable, what would be the "good" predictor variables for IQ?**



```{r}

cor(df$IQ, df)^2

```

